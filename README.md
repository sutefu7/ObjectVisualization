
# ObjectVisualization

## これは何ですか？

LINQPad の機能（変数の内容をグラフィカルに出力表示する機能）を、Visual Studio でデバッグ中に使いたいと思い、作成したライブラリです。
LINQPad 自体の機能は利用していないため、LINQPad が未インストールでも動作します。

業務コードや OSS 開発など、すでにあるソースを理解したいとか、変数の変化を時系列に追跡して、バグ調査したいなどの場面で利用できます。



## サンプルイメージ



## 使い方

### その１、静的参照（dll 参照追加）

プロジェクトファイル（xxx.vbproj, xxx.csproj）に変更点が入っても大丈夫だよ！後で消すよ！ができる場合は、参照の追加から本ライブラリを追加します。
ただし、調査用のコードは書く必要があり、使い終わったらそれを削除するのを忘れないようにしてください。


C#
using ObjectVisualization;

ObjectWatcher.Instance.Show()
ObjectWatcher.Instance.Dump()
または、
拡張メソッドの Dump()

VB.NET
Imports ObjectVisualization

ObjectWatcher.Instance.Show(TargetLanguageTypes.VBNET)
ObjectWatcher.Instance.Dump()

調査コードを書いたら、後はデバッグ実行します。ブレークポイントを設定しないで一気に実行してもいいですし、１行ずつステップ実行してもいいです。



### その２、動的参照（リフレクション利用）

プロジェクトファイルに変更点を加えたくない場合は、動的参照して使います。
ただし、やはり調査用のコードは書く必要があり、使い終わったらそれを削除するのを忘れないようにしてください。

以下は、リフレクション処理をラップしたメソッドとそれを使う側のサンプルです。




列挙体のリフレクション指定ってどうやるのか？



調査コードを書いたら、後はデバッグ実行します。ブレークポイントを設定しないで一気に実行してもいいですし、１行ずつステップ実行してもいいです。



## ダウンロード

ターゲット言語
C#
VB.NET


ターゲットフレームワーク
.NET Framework 3.5 版
.NET Framework 4.7.2 版



それ以外が欲しい方は、プロジェクト一式をダウンロードしてきて、ターゲットフレームワークを切り替えてリビルドすると作成できます。もしくは空のプロジェクトを作成して、ソースファイルを追加するなどです。



## 開発環境

Visual Studio Community 2017
C#
.NET Framework 3.5 版
.NET Framework 4.7.2 版


## 設計思想

完コピは目的ではないため、未実装の機能があったりします。また、一部の表現方法に差異があります。こっちの方が分かりやすいと思ったからとか、技術的に実現不可だったからとか、そういう理由からです。ただ、より良くするために将来直すかもです。

バグ指摘・要望、等々を受け付けています。ご連絡をお待ちしております。この時、もしも可能でしたらサンプルコードなどのお力添えがあると嬉しいです。



